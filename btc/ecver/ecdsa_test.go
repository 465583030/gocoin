package ecver

import (
	"testing"
)


func TestEcdsaVerify(t *testing.T) {
	var sig sig_t
	var pkey ge_t

	sig.r.SetString("FE00E013C244062847045AE7EB73B03FCA583E9AA5DBD030A8FD1C6DFCF11B10", 16)
	sig.s.SetString("7D0D04FED8FA1E93007468D5A9E134B0A7023B6D31DB4E50942D43A250F4D07C", 16)

	msg := new_num_from_string("3382219555DDBB5B00E0090F469E590BA1EAE03C7F28AB937DE330AA60294ED6", 16)
	pkey.x.SetString("0EAEBCD1DF2DF853D66CE0E1B0FDA07F67D1CABEFDE98514AAD795B86A6EA66D", 16)
	pkey.y.SetString("BEB26B67D7A00E2447BAECCC8A4CEF7CD3CAD67376AC1C5785AEEBB4F6441C16", 16)

	if !sig.verify(&pkey, msg) {
		t.Error("sig.verify failed")
	}
}
